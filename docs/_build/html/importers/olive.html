

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Olive XML importer &mdash; Impresso TextImporter  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Generic Mets/Alto importer" href="mets-alto.html" />
    <link rel="prev" title="TextImporter" href="../importers.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Impresso TextImporter
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../architecture.html">Overview</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../importers.html">TextImporter</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../importers.html#available-importers">Available importers</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Olive XML importer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#module-text_importer.importers.olive.classes">Custom classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-text_importer.importers.olive.detect">Detect functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-text_importer.importers.olive.parsers">Olive parsers</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-text_importer.importers.olive.helpers">Helper methods</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mets-alto.html">Generic Mets/Alto importer</a></li>
<li class="toctree-l3"><a class="reference internal" href="lux.html">BNL Mets/Alto importer</a></li>
<li class="toctree-l3"><a class="reference internal" href="rero.html">RERO Mets/Alto importer</a></li>
<li class="toctree-l3"><a class="reference internal" href="swa.html">SWA Alto importer</a></li>
<li class="toctree-l3"><a class="reference internal" href="bl.html">British Library Mets/Alto importer</a></li>
<li class="toctree-l3"><a class="reference internal" href="bnf.html">BNF Mets/Alto importer</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../importers.html#command-line-interface">Command-line interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../importers.html#configuration-file">Configuration file</a></li>
<li class="toctree-l2"><a class="reference internal" href="../importers.html#module-text_importer.utils">Utilities</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../custom_importer.html">Writing a new importer</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Impresso TextImporter</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../importers.html">TextImporter</a> &raquo;</li>
        
      <li>Olive XML importer</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/importers/olive.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="olive-xml-importer">
<h1>Olive XML importer<a class="headerlink" href="#olive-xml-importer" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-text_importer.importers.olive.classes">
<span id="custom-classes"></span><h2>Custom classes<a class="headerlink" href="#module-text_importer.importers.olive.classes" title="Permalink to this headline">¶</a></h2>
<p>Classes to handle the Olive XML OCR format.</p>
<dl class="class">
<dt id="text_importer.importers.olive.classes.OliveNewspaperIssue">
<em class="property">class </em><code class="descclassname">text_importer.importers.olive.classes.</code><code class="descname">OliveNewspaperIssue</code><span class="sig-paren">(</span><em>issue_dir: impresso_commons.path.path_fs.IssueDirectory</em>, <em>image_dirs: str</em>, <em>temp_dir: str</em><span class="sig-paren">)</span><a class="headerlink" href="#text_importer.importers.olive.classes.OliveNewspaperIssue" title="Permalink to this definition">¶</a></dt>
<dd><p>Class representing a newspaper issue in Olive format.</p>
<p>Upon object initialization the following things happen:</p>
<ul class="simple">
<li>the Zip archive containing the issue is uncompressed</li>
<li>the ToC file is parsed to determine the logical structure of the issue</li>
<li>page objects (instances of <code class="docutils literal notranslate"><span class="pre">OliveNewspaperPage</span></code>) are initialised.</li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>issue_dir</strong> (<em>IssueDir</em>) – Description of parameter <cite>issue_dir</cite>.</li>
<li><strong>image_dirs</strong> (<em>str</em>) – Path to the directory with the page images. Multiple
paths should be separated by comma (“,”).</li>
<li><strong>temp_dir</strong> (<em>str</em>) – Description of parameter <cite>temp_dir</cite>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="text_importer.importers.olive.classes.OliveNewspaperPage">
<em class="property">class </em><code class="descclassname">text_importer.importers.olive.classes.</code><code class="descname">OliveNewspaperPage</code><span class="sig-paren">(</span><em>_id: str</em>, <em>n: int</em>, <em>toc_data: dict</em>, <em>image_info</em>, <em>page_xml</em><span class="sig-paren">)</span><a class="headerlink" href="#text_importer.importers.olive.classes.OliveNewspaperPage" title="Permalink to this definition">¶</a></dt>
<dd><p>Class representing a page in Olive format.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>_id</strong> (<em>str</em>) – Canonical page ID.</li>
<li><strong>n</strong> (<em>int</em>) – Page number.</li>
<li><strong>toc_data</strong> (<em>dict</em>) – Metadata about content items in the newspaper issue.</li>
<li><strong>image_info</strong> (<em>dict</em>) – Metadata about the page image.</li>
<li><strong>page_xml</strong> (<em>str</em>) – Path to the Olive XML file of the page.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="text_importer.importers.olive.classes.OliveNewspaperPage.add_issue">
<code class="descname">add_issue</code><span class="sig-paren">(</span><em>issue: text_importer.importers.classes.NewspaperIssue</em><span class="sig-paren">)</span><a class="headerlink" href="#text_importer.importers.olive.classes.OliveNewspaperPage.add_issue" title="Permalink to this definition">¶</a></dt>
<dd><p>Add to a page object its parent, i.e. the newspaper issue.</p>
<p>This allows each page to preserve contextual information coming from
the newspaper issue.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>issue</strong> (<a class="reference internal" href="../custom_importer.html#text_importer.importers.classes.NewspaperIssue" title="text_importer.importers.classes.NewspaperIssue"><em>NewspaperIssue</em></a>) – Newspaper issue contaning this page.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="text_importer.importers.olive.classes.OliveNewspaperPage.parse">
<code class="descname">parse</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#text_importer.importers.olive.classes.OliveNewspaperPage.parse" title="Permalink to this definition">¶</a></dt>
<dd><p>Process the page file and transform into canonical format.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This lazy behavior means that the page contents are not processed
upon creation of the page object, but only once the <code class="docutils literal notranslate"><span class="pre">parse()</span></code>
method is called.</p>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-text_importer.importers.olive.detect">
<span id="detect-functions"></span><h2>Detect functions<a class="headerlink" href="#module-text_importer.importers.olive.detect" title="Permalink to this headline">¶</a></h2>
<dl class="attribute">
<dt id="text_importer.importers.olive.detect.OliveIssueDir">
<code class="descclassname">text_importer.importers.olive.detect.</code><code class="descname">OliveIssueDir</code><a class="headerlink" href="#text_importer.importers.olive.detect.OliveIssueDir" title="Permalink to this definition">¶</a></dt>
<dd><p>A light-weight data structure to represent a newspaper issue.</p>
<p>This named tuple contains basic metadata about a newspaper issue. They
can then be used to locate the relevant data in the filesystem or to create
canonical identifiers for the issue and its pages.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In case of newspaper published multiple times per day, a lowercase letter
is used to indicate the edition number: ‘a’ for the first, ‘b’ for the
second, etc.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>journal</strong> (<em>str</em>) – Newspaper ID</li>
<li><strong>date</strong> (<em>datetime.date</em>) – Publication date</li>
<li><strong>edition</strong> (<em>str</em>) – Edition of the newspaper issue (‘a’, ‘b’, ‘c’, etc.)</li>
<li><strong>path</strong> (<em>str</em>) – Path to the directory containing OCR data</li>
<li><strong>rights</strong> (<em>str</em>) – Access rights on the data (open, closed, etc.)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">datetime</span> <span class="k">import</span> <span class="n">date</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">i</span> <span class="o">=</span> <span class="n">OliveIssueDir</span><span class="p">(</span><span class="s1">&#39;GDL&#39;</span><span class="p">,</span> <span class="n">date</span><span class="p">(</span><span class="mi">1900</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;./GDL-1900-01-01/&#39;</span><span class="p">,</span> <span class="s1">&#39;open&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">text_importer.importers.olive.detect.OliveIssueDirectory</span></code></p>
</dd></dl>

<dl class="function">
<dt id="text_importer.importers.olive.detect.dir2olivedir">
<code class="descclassname">text_importer.importers.olive.detect.</code><code class="descname">dir2olivedir</code><span class="sig-paren">(</span><em>issue_dir: impresso_commons.path.path_fs.IssueDirectory</em>, <em>access_rights: dict</em><span class="sig-paren">)</span> &#x2192; text_importer.importers.olive.detect.OliveIssueDirectory<a class="headerlink" href="#text_importer.importers.olive.detect.dir2olivedir" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function that injects access rights info into an <code class="docutils literal notranslate"><span class="pre">IssueDir</span></code>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This function is called internally by <a class="reference internal" href="#text_importer.importers.olive.detect.olive_detect_issues" title="text_importer.importers.olive.detect.olive_detect_issues"><code class="xref py py-func docutils literal notranslate"><span class="pre">olive_detect_issues()</span></code></a>.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>issue_dir</strong> (<em>IssueDir</em>) – Input <code class="docutils literal notranslate"><span class="pre">IssueDir</span></code> object.</li>
<li><strong>access_rights</strong> (<em>dict</em>) – Access rights information.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">New <code class="docutils literal notranslate"><span class="pre">OliveIssueDir</span></code> object.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="text_importer.importers.olive.detect.olive_detect_issues">
<code class="descclassname">text_importer.importers.olive.detect.</code><code class="descname">olive_detect_issues</code><span class="sig-paren">(</span><em>base_dir: str</em>, <em>access_rights: str</em>, <em>journal_filter: set = None</em>, <em>exclude: bool = False</em><span class="sig-paren">)</span> &#x2192; List[text_importer.importers.olive.detect.OliveIssueDirectory]<a class="headerlink" href="#text_importer.importers.olive.detect.olive_detect_issues" title="Permalink to this definition">¶</a></dt>
<dd><p>Detect newspaper issues to import within the filesystem.</p>
<p>This function expects the directory structure that RERO used to
organize the dump of Olive OCR data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>base_dir</strong> (<em>str</em>) – Path to the base directory of newspaper data.</li>
<li><strong>access_rights</strong> (<em>str</em>) – Path to <code class="docutils literal notranslate"><span class="pre">access_rights.json</span></code> file.</li>
<li><strong>journal_filter</strong> (<em>set</em>) – IDs of newspapers to consider.</li>
<li><strong>exclude</strong> (<em>bool</em>) – Whether <code class="docutils literal notranslate"><span class="pre">journal_filter</span></code> should determine exclusion.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">List of <cite>OliveIssueDir</cite> instances, to be imported.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="text_importer.importers.olive.detect.olive_select_issues">
<code class="descclassname">text_importer.importers.olive.detect.</code><code class="descname">olive_select_issues</code><span class="sig-paren">(</span><em>base_dir: str</em>, <em>config: dict</em>, <em>access_rights: str</em><span class="sig-paren">)</span> &#x2192; List[text_importer.importers.olive.detect.OliveIssueDirectory]<a class="headerlink" href="#text_importer.importers.olive.detect.olive_select_issues" title="Permalink to this definition">¶</a></dt>
<dd><p>Detect selectively newspaper issues to import.</p>
<p>The behavior is very similar to <a class="reference internal" href="#text_importer.importers.olive.detect.olive_detect_issues" title="text_importer.importers.olive.detect.olive_detect_issues"><code class="xref py py-func docutils literal notranslate"><span class="pre">olive_detect_issues()</span></code></a> with the only
difference that <code class="docutils literal notranslate"><span class="pre">config</span></code> specifies some rules to filter the data to
import. See <a class="reference external" href="../importers.html#configuration-files">this section</a> for
further details on how to configure filtering.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>base_dir</strong> (<em>str</em>) – Path to the base directory of newspaper data.</li>
<li><strong>config</strong> (<em>dict</em>) – Config dictionary for filtering.</li>
<li><strong>access_rights</strong> (<em>str</em>) – Path to <code class="docutils literal notranslate"><span class="pre">access_rights.json</span></code> file.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">List of <cite>OliveIssueDir</cite> instances, to be imported.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-text_importer.importers.olive.parsers">
<span id="olive-parsers"></span><h2>Olive parsers<a class="headerlink" href="#module-text_importer.importers.olive.parsers" title="Permalink to this headline">¶</a></h2>
<p>Functions to parse Olive XML data.</p>
<dl class="function">
<dt id="text_importer.importers.olive.parsers.olive_image_parser">
<code class="descclassname">text_importer.importers.olive.parsers.</code><code class="descname">olive_image_parser</code><span class="sig-paren">(</span><em>text: bytes</em><span class="sig-paren">)</span> &#x2192; Optional[dict]<a class="headerlink" href="#text_importer.importers.olive.parsers.olive_image_parser" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse the Olive XML file contaning image metadata.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>text</strong> (<em>bytes</em>) – Content of the XML file to parse.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A dictionary of image metadata.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">Optional[dict]</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="text_importer.importers.olive.parsers.olive_parser">
<code class="descclassname">text_importer.importers.olive.parsers.</code><code class="descname">olive_parser</code><span class="sig-paren">(</span><em>text: str</em><span class="sig-paren">)</span> &#x2192; dict<a class="headerlink" href="#text_importer.importers.olive.parsers.olive_parser" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse an Olive XML file (e.g. from Le Temps corpus).</p>
<p>The main logic implemented here was derived from
&lt;<a class="reference external" href="https://github.com/dhlab-epfl/LeTemps-preprocessing/">https://github.com/dhlab-epfl/LeTemps-preprocessing/</a>&gt;. Each XML file
corresponds to one article, as detected by Olive.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>text</strong> (<em>string</em>) – content of the xml file to parse</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A dictionary with keys: <code class="docutils literal notranslate"><span class="pre">meta</span></code>, <code class="docutils literal notranslate"><span class="pre">r</span></code>, <code class="docutils literal notranslate"><span class="pre">stats</span></code>, <code class="docutils literal notranslate"><span class="pre">legacy</span></code>.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="text_importer.importers.olive.parsers.olive_toc_parser">
<code class="descclassname">text_importer.importers.olive.parsers.</code><code class="descname">olive_toc_parser</code><span class="sig-paren">(</span><em>toc_path: str</em>, <em>issue_dir: impresso_commons.path.path_fs.IssueDirectory</em>, <em>encoding: str = 'windows-1252'</em><span class="sig-paren">)</span> &#x2192; dict<a class="headerlink" href="#text_importer.importers.olive.parsers.olive_toc_parser" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse the TOC.xml file (Olive format).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>toc_path</strong> (<em>str</em>) – Path to the ToC XML file.</li>
<li><strong>issue_dir</strong> (<em>IssueDir</em>) – Corresponding <code class="docutils literal notranslate"><span class="pre">IssueDir</span></code> object.</li>
<li><strong>encoding</strong> (<em>str</em>) – XML file encoding.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A dictionary where keys are content item IDs and values their
metadata.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dict</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="text_importer.importers.olive.parsers.parse_styles">
<code class="descclassname">text_importer.importers.olive.parsers.</code><code class="descname">parse_styles</code><span class="sig-paren">(</span><em>text: str</em><span class="sig-paren">)</span> &#x2192; List[dict]<a class="headerlink" href="#text_importer.importers.olive.parsers.parse_styles" title="Permalink to this definition">¶</a></dt>
<dd><p>Turn Olive style file into a dictionary.</p>
<p>Style IDs may be referred to within the <code class="docutils literal notranslate"><span class="pre">s</span></code> property of token elements
as defined in the impresso JSON schema for newspaper pages (see
<a class="reference external" href="https://github.com/impresso/impresso-schemas/blob/master/docs/page.schema.md">documentation</a>).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>text</strong> (<em>str</em>) – textual content of file <cite>styleGallery.txt</cite></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A list of styles; each style has ID, font, font size, color (rgb).</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">List[dict]</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-text_importer.importers.olive.helpers">
<span id="helper-methods"></span><h2>Helper methods<a class="headerlink" href="#module-text_importer.importers.olive.helpers" title="Permalink to this headline">¶</a></h2>
<p>Helper functions used by the Olive Importer.</p>
<p>These functions are mainly used within (i.e. called by) the classes
<code class="docutils literal notranslate"><span class="pre">OliveNewspaperIssue</span></code> and <code class="docutils literal notranslate"><span class="pre">OliveNewspaperPage</span></code>.</p>
<dl class="function">
<dt id="text_importer.importers.olive.helpers.combine_article_parts">
<code class="descclassname">text_importer.importers.olive.helpers.</code><code class="descname">combine_article_parts</code><span class="sig-paren">(</span><em>article_parts: List[dict]</em><span class="sig-paren">)</span> &#x2192; dict<a class="headerlink" href="#text_importer.importers.olive.helpers.combine_article_parts" title="Permalink to this definition">¶</a></dt>
<dd><p>Merge article parts into a single element.</p>
<p>Olive format splits an article into multiple components whenever it spans
over multiple pages. Thus, it is necessary to recompose multiple parts.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>article_parts</strong> (<em>List</em><em>[</em><em>dict</em><em>]</em>) – one or more article parts</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A dictionary, with keys <code class="docutils literal notranslate"><span class="pre">meta</span></code>, <code class="docutils literal notranslate"><span class="pre">fulltext</span></code>, <code class="docutils literal notranslate"><span class="pre">stats</span></code>,
<code class="docutils literal notranslate"><span class="pre">legacy</span></code>.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="text_importer.importers.olive.helpers.convert_image_coordinates">
<code class="descclassname">text_importer.importers.olive.helpers.</code><code class="descname">convert_image_coordinates</code><span class="sig-paren">(</span><em>image</em>, <em>page_xml</em>, <em>page_image_name</em>, <em>zip_archive</em>, <em>box_strategy</em>, <em>issue</em><span class="sig-paren">)</span> &#x2192; bool<a class="headerlink" href="#text_importer.importers.olive.helpers.convert_image_coordinates" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert coordinates of an image.</p>
<p><strong>NB</strong>: This conversions is necessary since the coordinates recorded in the
XML file were computed on a different image than the one used for display
in the impresso interface.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>image</strong> (<em>dict</em>) – Image metadata.</li>
<li><strong>page_xml</strong> (<em>str</em>) – Content of Olive page XML.</li>
<li><strong>page_image_name</strong> (<em>str</em>) – Name of page image file.</li>
<li><strong>zip_archive</strong> (<em>ZipArchive</em>) – Olive Zip archive.</li>
<li><strong>box_strategy</strong> (<em>str</em>) – Conversion strategy to apply.</li>
<li><strong>issue</strong> (<a class="reference internal" href="#text_importer.importers.olive.classes.OliveNewspaperIssue" title="text_importer.importers.olive.classes.OliveNewspaperIssue"><em>OliveNewspaperIssue</em></a>) – Newspaper issue the page belongs to.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Whether the coordinate conversion was successful or not.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">bool</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="text_importer.importers.olive.helpers.convert_page_coordinates">
<code class="descclassname">text_importer.importers.olive.helpers.</code><code class="descname">convert_page_coordinates</code><span class="sig-paren">(</span><em>page</em>, <em>page_xml</em>, <em>page_image_name</em>, <em>zip_archive</em>, <em>box_strategy</em>, <em>issue</em><span class="sig-paren">)</span> &#x2192; bool<a class="headerlink" href="#text_importer.importers.olive.helpers.convert_page_coordinates" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert coordinates of all elements in a page that have coordinates.</p>
<p><strong>NB</strong>: This conversions is necessary since the coordinates recorded in the XML
file were computed on a different image than the one used for display in
the impresso interface.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>page</strong> (<a class="reference internal" href="#text_importer.importers.olive.classes.OliveNewspaperPage" title="text_importer.importers.olive.classes.OliveNewspaperPage"><em>OliveNewspaperPage</em></a>) – Page whose coordinates should be converted.</li>
<li><strong>page_xml</strong> (<em>str</em>) – Content of Olive page XML.</li>
<li><strong>page_image_name</strong> (<em>type</em>) – Name of page image file.</li>
<li><strong>zip_archive</strong> (<em>ZipArchive</em>) – Olive Zip archive.</li>
<li><strong>box_strategy</strong> (<em>str</em>) – Conversion strategy to apply.</li>
<li><strong>issue</strong> (<a class="reference internal" href="#text_importer.importers.olive.classes.OliveNewspaperIssue" title="text_importer.importers.olive.classes.OliveNewspaperIssue"><em>OliveNewspaperIssue</em></a>) – Newspaper issue the page belongs to.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Whether the coordinate conversion was successful or not.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">bool</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="text_importer.importers.olive.helpers.merge_pseudo_tokens">
<code class="descclassname">text_importer.importers.olive.helpers.</code><code class="descname">merge_pseudo_tokens</code><span class="sig-paren">(</span><em>line: dict</em><span class="sig-paren">)</span> &#x2192; dict<a class="headerlink" href="#text_importer.importers.olive.helpers.merge_pseudo_tokens" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove pseudo tokens from a line.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>line</strong> (<em>dict</em>) – a line of OCR in JSON format.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A new line object (with different number of tokens).</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="text_importer.importers.olive.helpers.merge_tokens">
<code class="descclassname">text_importer.importers.olive.helpers.</code><code class="descname">merge_tokens</code><span class="sig-paren">(</span><em>tokens: List[dict], line: str</em><span class="sig-paren">)</span> &#x2192; dict<a class="headerlink" href="#text_importer.importers.olive.helpers.merge_tokens" title="Permalink to this definition">¶</a></dt>
<dd><p>Merge two or more tokens into one.</p>
<p>The resulting (merged) token will have new coordinates corresponding
to the combination of coordinates of the input tokens.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>tokens</strong> (<em>List</em><em>[</em><em>dict</em><em>]</em>) – Tokens to merge.</li>
<li><strong>line</strong> (<em>str</em>) – The line of text to which the input tokens belong.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The new (merged) token.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dict</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="text_importer.importers.olive.helpers.normalize_hyphenation">
<code class="descclassname">text_importer.importers.olive.helpers.</code><code class="descname">normalize_hyphenation</code><span class="sig-paren">(</span><em>line: dict</em><span class="sig-paren">)</span> &#x2192; dict<a class="headerlink" href="#text_importer.importers.olive.helpers.normalize_hyphenation" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalize end-of-line hyphenated words.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>line</strong> (<em>dict</em>) – A line of OCR.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A new line element.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="text_importer.importers.olive.helpers.normalize_line">
<code class="descclassname">text_importer.importers.olive.helpers.</code><code class="descname">normalize_line</code><span class="sig-paren">(</span><em>line: dict</em>, <em>lang: str</em><span class="sig-paren">)</span><a class="headerlink" href="#text_importer.importers.olive.helpers.normalize_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply normalization to a line of OCR.</p>
<p>The normalization rules that are applied depend on the language in which
the text is written. This normalization is necessary because Olive, unlike
e.g. Mets, does not encode explicitly the presence/absence of whitespaces.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>line</strong> (<em>dict</em>) – A line of OCR text.</li>
<li><strong>lang</strong> (<em>str</em>) – Language of the text.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A new line of text.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dict</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="text_importer.importers.olive.helpers.recompose_ToC">
<code class="descclassname">text_importer.importers.olive.helpers.</code><code class="descname">recompose_ToC</code><span class="sig-paren">(</span><em>original_toc_data: dict, articles: List[dict], images: List[dict]</em><span class="sig-paren">)</span> &#x2192; List[dict]<a class="headerlink" href="#text_importer.importers.olive.helpers.recompose_ToC" title="Permalink to this definition">¶</a></dt>
<dd><p>Recompose the ToC of a newspaper issue.</p>
<p>Function used by
<a class="reference internal" href="#text_importer.importers.olive.classes.OliveNewspaperIssue" title="text_importer.importers.olive.classes.OliveNewspaperIssue"><code class="xref py py-class docutils literal notranslate"><span class="pre">OliveNewspaperIssue</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>original_toc_data</strong> (<em>dict</em>) – ToC data.</li>
<li><strong>articles</strong> (<em>List</em><em>[</em><em>dict</em><em>]</em>) – List of content items in the issue.</li>
<li><strong>images</strong> (<em>List</em><em>[</em><em>dict</em><em>]</em>) – List of images in the issue.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A new list of content items.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">List[dict]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="text_importer.importers.olive.helpers.recompose_page">
<code class="descclassname">text_importer.importers.olive.helpers.</code><code class="descname">recompose_page</code><span class="sig-paren">(</span><em>page_id: str</em>, <em>info_from_toc: dict</em>, <em>page_elements: dict</em>, <em>clusters: dict</em><span class="sig-paren">)</span> &#x2192; dict<a class="headerlink" href="#text_importer.importers.olive.helpers.recompose_page" title="Permalink to this definition">¶</a></dt>
<dd><p>Merge a list of page elements into a single one.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>page_id</strong> (<em>str</em>) – page id</li>
<li><strong>info_from_toc</strong> (<em>dict</em>) – a dictionary with page element IDs
(articles, ads.) as keys, and dictionaries as values</li>
<li><strong>page_elements</strong> (<em>dict</em>) – articles or advertisements</li>
<li><strong>clusters</strong> (<em>dict</em>) – an inverted index of legacy ids; if an id is part of
multipart article, the id is found not as a key but in one of the
values.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A new page element.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dict</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It is here that an <code class="docutils literal notranslate"><span class="pre">n</span></code> attribute is assigned to each
region/paragraph/line/token.</p>
</div>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="mets-alto.html" class="btn btn-neutral float-right" title="Generic Mets/Alto importer" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../importers.html" class="btn btn-neutral float-left" title="TextImporter" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Matteo Romanello &amp; Impresso team

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>